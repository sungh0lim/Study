# 02. 현실에서의 함수형 사고

- 현실적인 문제에 함수형 사고를 적용해 봅니다.
- 소프트웨어 구조를 잡는 데 계층형 설계가 좋은 이유를 설명합니다.
- 액션을 타임라인으로 시각화해 봅니다.
- 타임라인을 사용하면 시간에 관한 문제를 잘 풀 수 있다는 것을 배웁니다.

## 토니 피자에 오신 것을 환영합니다.

피자를 만드는 로봇이 JS 로 프로그래밍되어있고 함수형 사고를 많이 사용했다는 가정.

### 파트1: 액션과 계산, 데이터

액션과 계산, 데이터 각 분류에 해당하는 예를 살펴보고 코드에 적용한 계층형 설계(stratified design)원칙이 어떤 것인지 알아봅시다.

### 파트2: 일급 추상

가게에서는 여러 로봇이 함께 피자를 만드는 분산 시스템인데, 가끔 실패하는 분산 시스템을 이해하기 위해 타임라인 다이어그램을 사용했습니다.

여러 로봇이 협력할 수 있도록 함수를 인자로 받는 일급 함수(first-class function)를 사용했습니다.

## 파트1: 액션과 계산, 데이터

### 1. 액션

액션은 호출 횟수와 시점에 의존.

### 2. 계산

어떤 것을 결정하거나 계획하는 것

### 3. 데이터

변경 불가능한(immutable) 데이터를 가능한 많이 쓰려고 한다.

## 변경 가능성에 따라 코드 나누기

자주 바뀌는 것과 자주 뀌지 않는 것을 구분함.

함수형 프로그래머는 이와 같이 계층을 만드는 아키텍쳐 패턴을 계층형 설계라고 부른다.

## 파트2: 일급 추상

로봇 한 대가 피자를 만들기 위한 액션을 타임라인으로 확인함.

## 분산 시스템을 타임라인으로 시각화하기

타임라인 다이어그램을 통해 문제를 발견할 수 있음.

잘못 분산한 시스템은 엉뚱한 피자를 만들 수 있음.

## 각각의 타임라인은 다른 순서로 실행됩니다.

기본적으로 타임라인은 서로 순서를 맞출 수 없음.

타임라인을 서로 맞추지 않은 분산 시스템은 예측 불가능한 순서로 실행됩니다.

## 어려운 경험을 토앻 분산 시스템에 대해 배운 것

### 토니의 회고

1. 기본적으로 타임라인은 서로 순서를 맞추지 않습니다.
2. 액션이 실행되는 시간은 중요하지 않습니다.
3. 드물지만 타이밍이 어긋나는 경우는 실제 일어납니다.
4. 타임라인 다이어그램으로 시스템의 문제를 알 수 있습니다.

## 타임라인 커팅: 로봇이 서로 기다릴 수 있게 하기

타임라인 커팅(cutting)라고 부르는 기술을 쓰려고 합니다.

타임라인 커팅은 고차 동작(high-order operation)으로 구현합니다.

(현재는 Promise를 통해 가능하다.)

## 좋은 경험을 통해 타임라인에 대해 배운 것

1. 타임라인 커팅으로 서로 다른 작업들을 쉽게 이해할 수 있습니다.
2. 타임라인 다이어그램을 사용하면 시간에 따라 진행하는 작업을 쉽게 이해할 수 있습니다.
3. 타임라인 다이어그램은 유연합니다.

## 결론

유지보수 비용을 줄이기 위해 액션과 계산에 계층화 설계를 사용하였다.

로봇을 여러 대 사용하여 주방 효율을 높이고 타임라인 커팅을 사용하여 시간에 따라 발생하는 어려운 버그도 고쳤습니다.
